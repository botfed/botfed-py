from web3 import Web3
from ..rpc_utils.rotating_provider import RotatingHTTPProvider

TEST_POOL_ID = "0xb2cc224c1c9feE385f8ad6a55b4d94E92359DC59"  # USDC/ETH CLM
TEST_BLOCK = 31996073  # June 24 2025 ~ 11AM +- 1hr.


ETH_ADDR = "0x4200000000000000000000000000000000000006"
MULTICALL3_ADDR = "0xcA11bde05977b3631167028862bE2a173976CA11"
POS_MANAGER_ADDR = "0x827922686190790b37229fd06084350E74485b72"
POOL_FACTORY_ADDR = "0x5e7BB104d84c7CB9B682AaC2F3d509f5F406809A"


STABLECOINS = ["USDC", "USDT", "USD+"]


def get_w3(chain="BASE"):
    import dotenv
    import os
    from web3 import Web3

    dotenv.load_dotenv()

    urls = [os.environ.get("BASE_HTTP_URL_%s" % i) for i in range(1, 11)]
    urls = [el for el in urls if el is not None]
    assert urls, f"No RPC URLs found for chain {chain}"

    provider = RotatingHTTPProvider(urls)

    dotenv.load_dotenv()
    w3 = Web3(provider)
    # assert w3.is_connected(), "Failed to connect to an rpc"
    return w3


SECS_IN_MIN = 60
SECS_IN_HOUR = 3600
SECS_IN_DAY = SECS_IN_HOUR * 24
SECS_PER_BLOCK = 2

watch_pools = [
    "0xb2cc224c1c9feE385f8ad6a55b4d94E92359DC59",  # USDC/WETH
    "0xBE00fF35AF70E8415D0eB605a286D8A45466A4c1",  # AERO/USDC
    "0x4e962BB3889Bf030368F56810A9c96B83CB3E778",  # cbBTC/USDC
    "0x70aCDF2Ad0bf2402C957154f944c19Ef4e1cbAE1",  # cbBTC/WETH
    "0x4a79B0168296c0eF7b8F314973B82aD406a29f1B",  # AAVE/WETH
    "0x41D60eD9C8327EA0c6b16a44343c177E0402FeeA",  # PROMPT/cbBTC
    "0x4e829F8A5213c42535AB84AA40BD4aDCCE9cBa02",  # WETH/BRETT
    "0x82321f3BEB69f503380D6B233857d5C43562e2D0",  # WETH/AERO
    "0xC200F21EfE67c7F41B81A854c26F9cdA80593065",  # VIRTUAL/WETH 200
    "0x3c5428b3D6e07f6de38b0c7F84ea9d30b3b27231",  # EIGEN / WETH
    "0xE8833415Bd6Aee9c0c7B6aaD7DC80421C3F28ca1",  # WETH / COOKIE
    # '0xE2B3aA806e56603a244bFc111c9474F7DeDD03db',  # MAMO / cbBTC
    "0x4BA1e3E9280facbAcaFA7baF4aE0b78Bea60beCa",  # WETH / SPX
    # "0x54cdD0222dF6B3BC17754c2C1B3d7D4203FE3d89",  # WETH / REI
    "0x3f0296BF652e19bca772EC3dF08b32732F93014A",  # WETH / VIRTUAL 100
    "0x56b92E5B391DbFb8b8028AC95A4b97f52ffEB416",  # WETH / KAITO
    "0x8A7b72F8ff5299E493317D4430293894107af859",  # WETH / SIGN
    "0xB099C658e784b41EE435d48a8eb67e8f27285C93",  # WETH / B3
    "0x29AF315b3Bd7566005f14d81C582b59E1C632fFd",  # WETH / HYPER
    "0x2092f4acbb18BB1649595DF59B9Cb601bBA1EBB7",  # WETH / RDNT
    "0xaFB62448929664Bfccb0aAe22f232520e765bA88",  # WETH / DEGEN
    "0xB5F0b4aE66C14F7EFaA9aA1468E8FC536A3E288c",  # WETH / MORPHO
    "0x5C45b0F48c326f79b56709d8F63CE2beE7697106",  # WETH / uSUI
    "0x22A52bB644f855ebD5ca2edB643FF70222D70C31",  # WETH / AIXBT
    # "0x3f53f1Fd5b7723DDf38D93a584D280B9b94C3111",  # ZORA / USDC
    # "0x5d4e504EB4c526995E0cC7A6E327FDa75D8B52b5",  # WETH / EURC
]

TOKEN_WHITELIST = {
    "cbBTC": "0xcbB7C0000aB88B473b1f5aFd9ef808440eed33Bf",
    "WETH": "0x4200000000000000000000000000000000000006",
    "VIRTUAL": "0x0b3e328455c4059EEb9e3f84b5543F74E24e7E1b",
    "AIXBT": "0x4F9Fd6Be4a90f2620860d680c0d4d5Fb53d1A825",
    "BRETT": "0x532f27101965dd16442e59d40670faf5ebb142e4",
    "AERO": "0x940181a94a35a4569e4529a3cdfb74e38fd98631",
    "USDC": "0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",
    "KAITO": "0x98d0baa52b2d063e780de12f615f963fe8537553",
    "ZORA": "0x1111111111166b7fe7bd91427724b487980afc69",
}

TOKEN_WHITELIST = {k: Web3.to_checksum_address(v) for k, v in TOKEN_WHITELIST.items()}